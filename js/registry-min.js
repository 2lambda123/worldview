SOTE.namespace("util");SOTE.util.Registry=function(){this.compRegistry=new Array();this.evtRegistry=new Array();this.consumers=new Array();this.readyRegistry=new Array();this.allReadyCallbacks=new Array();this.register=function a(x,v){var w=new h(x,v);this.storeComponent(x,w)};function h(w,v){this.name=w;this.obj=v;return this}function c(w,v){this.consumerId=w;this.producerId=v;return this}this.addEventListener=function i(z,w){if(w!=null||w!="undefined"||w!=""){for(var x=1;x<arguments.length;x++){var v=new t(z,arguments[x]);var y=new n(arguments[x],v);this.storeEvent(z,v);this.consumers.push(new c(arguments[x],z))}}};this.storeEvent=function g(w,v){this.evtRegistry.push(v)};this.getEvents=function u(x){var w=new Array();for(var v=0;v<this.evtRegistry.length;v++){if(x==this.evtRegistry[v].name){w.push(this.evtRegistry[v])}}return w};this.fire=function o(w,v){if(v==null){v="norecurse=xxx"}if(w!=null){var B=this.getEvents(this.getComponentId(w));if(B.length>0){var A=new Array();for(var z=0;z<B.length;z++){A=this.getConsumers(B[z].consumerId);var y="";for(var x=0;x<A.length;x++){if(A[x]==this.getComponentId(w)){y=A[x];break}}if(B[z].consumerId!=v.split("=")[1]){B[z].componentUpdate.fire(w.getValue())}}}}else{alert("Registry: fire: comp is null")}};this.syncComponents=function(){var y=this.getComponents();var v=new Array();var w;for(var x=0;x<y.length;x++){w=this.getProducers(y[x].id);if(w.length>0){v=v.concat(w)}}for(var x=0;x<v.length;x++){this.fire(this.getComponent(v[x]))}};this.getDependentValues=function(v,x){var y="";for(var w=0;w<this.consumers.length;w++){if(this.consumers[w].consumerId==v&&this.consumers[w].producerId!=x){y+=this.getComponent(this.consumers[w].producerId).getValue()+"&"}}y=y.substring(0,y.length-1);return y};function t(w,v){this.name=w;this.consumerId=v;this.componentUpdate=new YAHOO.util.CustomEvent("componentUpdate",this);return this}function n(w,v){this.name=w;this.evtObj=v;this.evtObj.componentUpdate.subscribe(this.onComponentUpdate,this);return this}n.prototype.onComponentUpdate=function(y,w,z){var x=getRegistryDependentValues(z.name,this.name);if(x!=""){w=w+"&"+x}var v=getGComponent(z.name);if(v!=null){v.updateComponent(w)}};this.addConsumer=function d(w){var x;for(var v=0;v<this.consumers.length;v++){x=this.consumers[v];if(w.id==x.id){this.consumers.splice(v,1);break}}this.consumers.push(w)};this.getConsumer=function l(x){var w;for(var v=0;v<this.consumers.length;v++){w=this.consumers[v];if(x==w.id){break}}return w};this.storeComponent=function b(w,v){var y;for(var x=0;x<this.compRegistry.length;x++){y=this.compRegistry[x];if(w==y.name){this.compRegistry.splice(x,1);break}}this.compRegistry.push(v)};this.getComponent=function j(x){var w;for(var v=0;v<this.compRegistry.length;v++){w=this.compRegistry[v];if(x==w.name){break}}return w.obj};this.getComponentId=function m(w){var x;for(var v=0;v<this.compRegistry.length;v++){x=this.compRegistry[v];if(w==x.obj){break}}return x.name};this.getComponents=function k(){var v=new Array();for(var w=0;w<this.compRegistry.length;w++){v.push(this.compRegistry[w])}return v};this.checkComponentsReady=function q(){var y=true;var A=this.getComponents();for(var w=0;w<A.length;w++){if(A[w].obj.loadFromQuery==undefined){continue}var x=false;for(var v=0;v<this.readyRegistry.length;v++){if(this.readyRegistry[v]==A[w].name){x=true}}if(!x){y=false;break}}if(y){for(var w=0;w<this.allReadyCallbacks.length;w++){var z=this.allReadyCallbacks[w];z()}}};this.addAllReadyCallback=function p(v){this.allReadyCallbacks.push(v);this.checkComponentsReady()};this.markComponentReady=function s(v){this.readyRegistry.push(v);this.checkComponentsReady()};this.getUIComponents=function f(){var w=this.getComponents();var v=new Array();for(var x=0;x<w.length;x++){if(w[x].obj.loadFromQuery){v.push(w[x].obj)}}return v};this.getProducers=function e(w){var v=new Array();for(var x=0;x<this.consumers.length;x++){if(this.consumers[x].consumerId==w){v.push(this.consumers[x].producerId)}}return v};this.getConsumers=function r(x){var w=new Array();for(var v=0;v<this.consumers.length;v++){if(this.consumers[v].producerId==x){w.push(this.consumers[v].consumerId)}}return w}};var REGISTRY=new SOTE.util.Registry();function getGComponent(a){return REGISTRY.getComponent(a)}function getRegistryDependentValues(b,a){return REGISTRY.getDependentValues(b,a)};